<class 'numpy.ndarray'>
(876, 10, 16, 16)
(876, 24, 16, 16)
Number of training samples:  876
Number of testing samples:  876
Dimension of Data: (876, 10, 16, 16) (876, 10, 16, 16)
Number of all Data 1752
Number of batches:  55
  0%|          | 0/2000 [00:00<?, ?it/s]Unet_training_torch.py:391: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  inputs = Variable(inputs, volatile=True).cuda()
Unet_training_torch.py:392: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  labels = Variable(labels, volatile=True).cuda()
libibverbs: Warning: couldn't open config directory '/etc/libibverbs.d'.
                                        [1,     5] loss: -0.013 
  0%|          | 0/2000 [00:06<?, ?it/s][1,    10] loss: -0.195 
                                          0%|          | 0/2000 [00:06<?, ?it/s][1,    15] loss: -0.468 
                                          0%|          | 0/2000 [00:07<?, ?it/s][1,    20] loss: -0.743 
                                          0%|          | 0/2000 [00:08<?, ?it/s][1,    25] loss: -0.905 
                                          0%|          | 0/2000 [00:08<?, ?it/s][1,    30] loss: -0.921 
                                          0%|          | 0/2000 [00:09<?, ?it/s][1,    35] loss: -0.950 
                                          0%|          | 0/2000 [00:10<?, ?it/s][1,    40] loss: -0.956 
                                          0%|          | 0/2000 [00:11<?, ?it/s][1,    45] loss: -0.967 
                                          0%|          | 0/2000 [00:11<?, ?it/s][1,    50] loss: -0.966 
                                          0%|          | 0/2000 [00:12<?, ?it/s][1,    55] loss: -0.948 
                                          0%|          | 0/2000 [00:13<?, ?it/s]Pruning threshold: 8.80885636433959e-07
layer index: 2 	 total params: 23520 	 remaining params: 23519
layer index: 8 	 total params: 115200 	 remaining params: 115200
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 5.6511254009627976e-12
layer index: 14 	 total params: 1474560 	 remaining params: 1474560
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 6.856222967144276e-08
layer index: 38 	 total params: 115200 	 remaining params: 115199
layer index: 44 	 total params: 56448 	 remaining params: 56448
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
Unet_training_torch.py:520: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  tinputs = Variable(tinputs, volatile=True).cuda()
Unet_training_torch.py:521: UserWarning: volatile was removed and now has no effect. Use `with torch.no_grad():` instead.
  tlabels = Variable(tlabels, volatile=True).cuda()
Reconstructed correlation 0.8151403293896895
test loss:    0%|          | 1/2000 [00:29<16:13:15, 29.21s/it]-0.9184659491885793
[2,     5] loss: -0.932 
                                                     0%|          | 1/2000 [00:29<16:13:15, 29.21s/it][2,    10] loss: -0.960 
                                                     0%|          | 1/2000 [00:30<16:13:15, 29.21s/it][2,    15] loss: -0.945 
                                                     0%|          | 1/2000 [00:31<16:13:15, 29.21s/it]                                                   [2,    20] loss: -0.964 
  0%|          | 1/2000 [00:32<16:13:15, 29.21s/it]                                                   [2,    25] loss: -0.973 
  0%|          | 1/2000 [00:32<16:13:15, 29.21s/it]                                                   [2,    30] loss: -0.935 
  0%|          | 1/2000 [00:33<16:13:15, 29.21s/it]                                                   [2,    35] loss: -0.955 
  0%|          | 1/2000 [00:34<16:13:15, 29.21s/it]                                                   [2,    40] loss: -0.963 
  0%|          | 1/2000 [00:35<16:13:15, 29.21s/it]                                                   [2,    45] loss: -0.972 
  0%|          | 1/2000 [00:35<16:13:15, 29.21s/it]                                                   [2,    50] loss: -0.968 
  0%|          | 1/2000 [00:36<16:13:15, 29.21s/it][2,    55] loss: -0.962 
                                                     0%|          | 1/2000 [00:37<16:13:15, 29.21s/it]Pruning threshold: 8.662385653224192e-08
layer index: 2 	 total params: 23520 	 remaining params: 23520
layer index: 8 	 total params: 115200 	 remaining params: 115199
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 1.9216926661069778e-11
layer index: 14 	 total params: 1474560 	 remaining params: 1474560
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 1.8849974026124983e-08
layer index: 38 	 total params: 115200 	 remaining params: 115199
layer index: 44 	 total params: 56448 	 remaining params: 56448
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
Reconstructed correlation 0.8683985304820456
test loss:  -0.9428291906010021  0%|          | 2/2000 [00:53<15:20:56, 27.66s/it]
[3,     5] loss: -0.951 
                                                     0%|          | 2/2000 [00:53<15:20:56, 27.66s/it]                                                   [3,    10] loss: -0.976 
  0%|          | 2/2000 [00:54<15:20:56, 27.66s/it][3,    15] loss: -0.950 
                                                     0%|          | 2/2000 [00:55<15:20:56, 27.66s/it][3,    20] loss: -0.965 
                                                     0%|          | 2/2000 [00:56<15:20:56, 27.66s/it][3,    25] loss: -0.949 
                                                     0%|          | 2/2000 [00:56<15:20:56, 27.66s/it]                                                   [3,    30] loss: -0.933 
  0%|          | 2/2000 [00:57<15:20:56, 27.66s/it][3,    35] loss: -0.972 
                                                     0%|          | 2/2000 [00:58<15:20:56, 27.66s/it][3,    40] loss: -0.970 
                                                     0%|          | 2/2000 [00:59<15:20:56, 27.66s/it]                                                   [3,    45] loss: -0.975 
  0%|          | 2/2000 [00:59<15:20:56, 27.66s/it]                                                   [3,    50] loss: -0.950 
  0%|          | 2/2000 [01:00<15:20:56, 27.66s/it][3,    55] loss: -0.953 
                                                     0%|          | 2/2000 [01:01<15:20:56, 27.66s/it]Pruning threshold: 5.562341698350792e-08
layer index: 2 	 total params: 23520 	 remaining params: 23520
layer index: 8 	 total params: 115200 	 remaining params: 115199
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 7.841730736979358e-13
layer index: 14 	 total params: 1474560 	 remaining params: 1474560
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 2.0020762292460859e-07
layer index: 38 	 total params: 115200 	 remaining params: 115199
layer index: 44 	 total params: 56448 	 remaining params: 56448
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
Reconstructed correlation 0.8978484286138559
test loss:    0%|          | 3/2000 [01:17<14:43:08, 26.53s/it]-0.9513913349671798
                                                     0%|          | 3/2000 [01:17<14:43:08, 26.53s/it][4,     5] loss: -0.958 
                                                     0%|          | 3/2000 [01:18<14:43:08, 26.53s/it][4,    10] loss: -0.981 
                                                   [4,    15] loss: -0.953 
  0%|          | 3/2000 [01:19<14:43:08, 26.53s/it]                                                     0%|          | 3/2000 [01:20<14:43:08, 26.53s/it][4,    20] loss: -0.967 
[4,    25] loss: -0.933 
                                                     0%|          | 3/2000 [01:20<14:43:08, 26.53s/it]                                                   [4,    30] loss: -0.928 
  0%|          | 3/2000 [01:21<14:43:08, 26.53s/it][4,    35] loss: -0.970 
                                                     0%|          | 3/2000 [01:22<14:43:08, 26.53s/it][4,    40] loss: -0.971 
                                                     0%|          | 3/2000 [01:23<14:43:08, 26.53s/it]                                                     0%|          | 3/2000 [01:23<14:43:08, 26.53s/it][4,    45] loss: -0.977 
                                                   [4,    50] loss: -0.972 
  0%|          | 3/2000 [01:24<14:43:08, 26.53s/it][4,    55] loss: -0.938 
                                                     0%|          | 3/2000 [01:25<14:43:08, 26.53s/it]Pruning threshold: 6.246416432986734e-07
layer index: 2 	 total params: 23520 	 remaining params: 23519
layer index: 8 	 total params: 115200 	 remaining params: 115200
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 1.652982004746173e-12
layer index: 14 	 total params: 1474560 	 remaining params: 1474560
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 1.1338114447312364e-08
layer index: 38 	 total params: 115200 	 remaining params: 115199
layer index: 44 	 total params: 56448 	 remaining params: 56448
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
  0%|          | 4/2000 [01:41<14:17:01, 25.76s/it]Reconstructed correlation 0.8138599865554351
test loss:  -0.9207914059812372
[5,     5] loss: -0.943 
                                                     0%|          | 4/2000 [01:41<14:17:01, 25.76s/it][5,    10] loss: -0.977 
                                                     0%|          | 4/2000 [01:42<14:17:01, 25.76s/it][5,    15] loss: -0.953 
                                                     0%|          | 4/2000 [01:43<14:17:01, 25.76s/it][5,    20] loss: -0.970 
                                                     0%|          | 4/2000 [01:44<14:17:01, 25.76s/it]                                                   [5,    25] loss: -0.978 
  0%|          | 4/2000 [01:44<14:17:01, 25.76s/it][5,    30] loss: -0.914 
                                                     0%|          | 4/2000 [01:45<14:17:01, 25.76s/it][5,    35] loss: -0.946 
                                                     0%|          | 4/2000 [01:46<14:17:01, 25.76s/it][5,    40] loss: -0.965 
                                                     0%|          | 4/2000 [01:47<14:17:01, 25.76s/it]                                                   [5,    45] loss: -0.974 
  0%|          | 4/2000 [01:47<14:17:01, 25.76s/it][5,    50] loss: -0.973 
                                                     0%|          | 4/2000 [01:48<14:17:01, 25.76s/it][5,    55] loss: -0.980 
                                                     0%|          | 4/2000 [01:49<14:17:01, 25.76s/it]Pruning threshold: 3.578174130325351e-07
layer index: 2 	 total params: 23520 	 remaining params: 23520
layer index: 8 	 total params: 115200 	 remaining params: 115199
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 1.3578613060338807e-13
layer index: 14 	 total params: 1474560 	 remaining params: 1474559
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 1.65736917523418e-08
layer index: 38 	 total params: 115200 	 remaining params: 115200
layer index: 44 	 total params: 56448 	 remaining params: 56447
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
  0%|          | 5/2000 [02:05<13:58:44, 25.23s/it]Reconstructed correlation 0.9451866629840048
test loss:  -0.9640869075601751
                                                   [6,     5] loss: -0.963 
  0%|          | 5/2000 [02:05<13:58:44, 25.23s/it][6,    10] loss: -0.924 
                                                     0%|          | 5/2000 [02:06<13:58:44, 25.23s/it][6,    15] loss: -0.941 
                                                     0%|          | 5/2000 [02:07<13:58:44, 25.23s/it][6,    20] loss: -0.965 
                                                     0%|          | 5/2000 [02:08<13:58:44, 25.23s/it]                                                   [6,    25] loss: -0.978 
  0%|          | 5/2000 [02:08<13:58:44, 25.23s/it][6,    30] loss: -0.951 
                                                     0%|          | 5/2000 [02:09<13:58:44, 25.23s/it][6,    35] loss: -0.975 
                                                     0%|          | 5/2000 [02:10<13:58:44, 25.23s/it][6,    40] loss: -0.941 
                                                     0%|          | 5/2000 [02:11<13:58:44, 25.23s/it][6,    45] loss: -0.935 
                                                     0%|          | 5/2000 [02:11<13:58:44, 25.23s/it][6,    50] loss: -0.964 
                                                     0%|          | 5/2000 [02:12<13:58:44, 25.23s/it][6,    55] loss: -0.976 
                                                     0%|          | 5/2000 [02:13<13:58:44, 25.23s/it]Pruning threshold: 8.636026649355699e-08
layer index: 2 	 total params: 23520 	 remaining params: 23520
layer index: 8 	 total params: 115200 	 remaining params: 115199
Total conv params: 138720, Pruned conv params: 1.0, Pruned ratio: 7.2087659646058455e-06
Pruning threshold: 5.272290172801328e-14
layer index: 14 	 total params: 1474560 	 remaining params: 1474559
layer index: 18 	 total params: 614400 	 remaining params: 614400
layer index: 22 	 total params: 40960 	 remaining params: 40960
layer index: 25 	 total params: 40960 	 remaining params: 40960
layer index: 29 	 total params: 614400 	 remaining params: 614400
layer index: 33 	 total params: 1474560 	 remaining params: 1474560
layer index: 49 	 total params: 37748736 	 remaining params: 37748736
Total Linear params: 42008576, Pruned Linear params: 0.0, Pruned ratio: 0.0
Pruning threshold: 4.819779775289135e-08
layer index: 38 	 total params: 115200 	 remaining params: 115200
layer index: 44 	 total params: 56448 	 remaining params: 56447
Total ConvTranspose2d params: 171648, Pruned ConvTranspose2d params: 1.0, Pruned ratio: 5.825876087328652e-06
  0%|          | 5/2000 [02:20<15:37:31, 28.20s/it]
Traceback (most recent call last):
  File "Unet_training_torch.py", line 525, in <module>
    np.transpose(tlabels.cpu().detach().numpy(),(0,2,3,1)).astype(np.float32))
  File "Unet_training_torch.py", line 82, in find_correlation
    correlations[i, j] = np.corrcoef(X_r, X_o, rowvar=False)[0, 1]
  File "<__array_function__ internals>", line 6, in corrcoef
  File "/home/yz87/anaconda3/envs/torchpy3_7/lib/python3.7/site-packages/numpy/lib/function_base.py", line 2551, in corrcoef
    c = cov(x, y, rowvar)
  File "<__array_function__ internals>", line 6, in cov
  File "/home/yz87/anaconda3/envs/torchpy3_7/lib/python3.7/site-packages/numpy/lib/function_base.py", line 2479, in cov
    c = dot(X, X_T.conj())
  File "<__array_function__ internals>", line 6, in dot
KeyboardInterrupt
